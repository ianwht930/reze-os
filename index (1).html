<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reze OS V42 - Bomb Devil</title>
    
    <link rel="icon" type="image/gif" href="reze.gif">
    
    <link rel="apple-touch-icon" href="apple-touch-icon.png?v=999">

    <link rel="stylesheet" href="style.css">
</head>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;300;400;500;700&family=Shippori+Mincho:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* --- 1. æ ¸å¿ƒé…è‰² (Reze Palette) --- */
        :root {
            --primary: #d4a3ff;
            --accent: #5ef7c9;
            --danger: #ff2a2a;
            --dark: #080808;
            --text-main: #ffffff;
            --glow-color: rgba(212, 163, 255, 0.4);
            --netflix-red: #E50914;
            --spotify-green: #1DB954;
        }
        
        body.combat-mode {
            --primary: #ff2a2a;
            --accent: #ffcc00;
            --glow-color: rgba(255, 42, 42, 0.8);
        }
        body {
            margin: 0; padding: 0;
            font-family: 'Noto Sans JP', sans-serif;
            height: 100vh; overflow: hidden;
            background-color: var(--dark);
            color: var(--text-main);
            user-select: none;
            cursor: crosshair;
            transition: background 0.5s ease-in-out;
            perspective: 1000px;
        }

        /* è¢å¹•éœ‡å‹•ç‰¹æ•ˆ Class */
        .shake-effect {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* èƒŒæ™¯è™•ç† */
        #bg-video {
            position: fixed; top: -5%; left: -5%; width: 110%; height: 110%;
            z-index: -10; object-fit: cover;
            filter: brightness(0.4) grayscale(0.4) contrast(1.1);
            transition: transform 0.1s cubic-bezier(0.25, 0.46, 0.45, 0.94), filter 1s;
        }
        body.combat-mode #bg-video { 
            filter: brightness(0.3) grayscale(1) sepia(1) hue-rotate(-50deg) contrast(1.5); 
        }

        /* ç¶²æ ¼èˆ‡ç‰¹æ•ˆ */
        .grid-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none; z-index: 1;
        }
        .vignette {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 40%, #000 100%);
            pointer-events: none; z-index: 2;
        }
        #fx-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 5;
        }

        /* æˆ°é¬¥æ¨¡å¼ç„æº–ä»‹é¢ */
        .combat-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 4;
            opacity: 0; transition: 0.5s;
            box-shadow: inset 0 0 100px rgba(255,0,0,0);
        }
        body.combat-mode .combat-overlay {
            opacity: 1;
            background: 
                linear-gradient(to right, var(--danger) 2px, transparent 2px) 0 0,
                linear-gradient(to bottom, var(--danger) 2px, transparent 2px) 0 0;
            background-size: 100% 100%;
            box-shadow: inset 0 0 50px rgba(255, 42, 42, 0.2);
        }
        /* åå­—æº–å¿ƒ */
        .crosshair-lines {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; height: 300px;
            border: 1px solid rgba(255,0,0,0);
            transition: 0.5s;
        }
        body.combat-mode .crosshair-lines {
            border: 1px solid rgba(255, 42, 42, 0.3);
            width: 80%; height: 80%;
            animation: targetLock 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes targetLock {
            0% { width: 100%; height: 100%; opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
            100% { width: 80%; height: 80%; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        /* --- 2. ä»‹é¢å…ƒä»¶ --- */
        .glitch-hover {
            position: relative; display: inline-block; transition: 0.3s;
        }
        .glitch-hover:hover {
            text-shadow: 2px 0 var(--primary), -2px 0 var(--accent);
            animation: glitch-skew 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite;
            color: #fff;
        }
        @keyframes glitch-skew {
            0% { transform: skew(0deg); }
            20% { transform: skew(-2deg); }
            40% { transform: skew(2deg); }
            60% { transform: skew(-1deg); }
            80% { transform: skew(1deg); }
            100% { transform: skew(0deg); }
        }

        /* HUD ä½ˆå±€ */
        .hud-container {
            position: absolute; top: 10%; left: 8%; z-index: 10;
        }

        .greeting-jp {
            font-family: 'Shippori Mincho', serif;
            font-size: 32px; color: var(--text-main);
            font-weight: 700; letter-spacing: 2px;
            margin-bottom: 5px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.8);
        }
        
        .clock-huge {
            font-family: 'Rajdhani', sans-serif;
            font-size: 130px; font-weight: 700;
            line-height: 0.8; color: #fff;
            text-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin-left: -5px;
            transition: color 0.3s;
            font-variant-numeric: tabular-nums;
        }
        .clock-huge:hover { color: var(--primary); }

        .date-jp {
            font-size: 16px; color: var(--accent);
            letter-spacing: 4px; margin-top: 10px; margin-bottom: 20px;
            font-weight: 500;
            display: flex; align-items: center; gap: 10px;
        }
        .date-jp::before { content: ''; width: 30px; height: 1px; background: var(--accent); }

        .reze-status-box {
            margin-bottom: 30px;
            font-family: 'Shippori Mincho', serif;
            color: rgba(255,255,255,0.7);
            font-size: 14px; letter-spacing: 2px;
            min-height: 20px; display: flex; align-items: center;
        }
        .reze-status-box i { margin-right: 10px; font-size: 12px; color: var(--primary); }

        /* å®‰å…¨æ “ (THE PIN) */
        .pin-system {
            display: inline-flex; align-items: center; gap: 20px;
            padding: 15px 25px;
            background: rgba(10,10,10,0.6);
            border: 1px solid rgba(255,255,255,0.15);
            backdrop-filter: blur(5px);
            border-left: 3px solid var(--primary);
            transition: 0.4s;
        }
        .pin-system:hover { 
            border-color: var(--accent); 
            border-left-color: var(--accent);
            transform: translateX(10px);
        }
        body.combat-mode .pin-system { border-left-color: var(--danger); background: rgba(30,0,0,0.6); }

        .choker-pin {
            width: 44px; height: 44px;
            border: 3px solid var(--primary);
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        .choker-pin::before {
            content: ''; position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            width: 2px; height: 15px; background: rgba(255,255,255,0.3);
        }
        .choker-pin i { font-size: 18px; color: var(--primary); transition: 0.3s; }
        .choker-pin:hover { transform: scale(1.1) rotate(15deg); box-shadow: 0 0 15px var(--primary); }
        .choker-pin:active { transform: scale(0.9); }
        body.combat-mode .choker-pin { 
            border-color: var(--danger); 
            transform: rotate(180deg);
            box-shadow: 0 0 20px var(--danger);
        }
        body.combat-mode .choker-pin i { color: var(--danger); }

        .status-group { display: flex; flex-direction: column; }
        .status-label { font-size: 10px; color: #888; letter-spacing: 1px; }
        .status-main { 
            font-size: 20px; font-weight: 700; color: #fff; 
            font-family: 'Shippori Mincho', serif; letter-spacing: 1px;
        }

        /* Google Search */
        .search-box { margin-top: 30px; position: relative; width: 300px; }
        .search-input {
            width: 100%; background: transparent;
            border: none; border-bottom: 1px solid rgba(255,255,255,0.3);
            color: #fff; padding: 10px 0; font-size: 16px;
            font-family: 'Noto Sans JP', sans-serif;
            transition: 0.3s;
        }
        .search-input:focus { outline: none; border-bottom-color: var(--primary); padding-left: 10px; }
        .search-icon { 
            position: absolute; right: 0; top: 10px; 
            color: var(--primary); font-size: 14px; cursor: pointer; transition: 0.2s;
        }
        .search-icon:hover { color: #fff; transform: scale(1.2) rotate(90deg); }

        /* --- 3. æ‡‰ç”¨ç¨‹å¼çŸ©é™£ (App Matrix) --- */
        .app-bar {
            position: absolute; bottom: 8%; left: 8%;
            display: flex; gap: 20px; z-index: 10;
            align-items: flex-end;
        }
        
        .app-icon {
            width: 50px; height: 50px;
            display: flex; justify-content: center; align-items: center;
            font-size: 22px; color: rgba(255,255,255,0.7);
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.03);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer; text-decoration: none;
            border-radius: 12px;
            position: relative;
            backdrop-filter: blur(4px);
        }

        .app-icon:hover {
            color: #fff; background: rgba(255,255,255,0.15);
            border-color: var(--primary); 
            transform: translateY(-8px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        
        .app-icon.netflix-color:hover {
            border-color: var(--netflix-red);
            box-shadow: 0 0 15px rgba(229, 9, 20, 0.4);
        }
        .app-icon.netflix-color:hover i { color: var(--netflix-red); text-shadow: 0 0 10px var(--netflix-red); }

        .app-icon.spotify-color:hover {
            border-color: var(--spotify-green);
            box-shadow: 0 0 15px rgba(29, 185, 84, 0.4);
        }
        .app-icon.spotify-color:hover i { color: var(--spotify-green); text-shadow: 0 0 10px var(--spotify-green); }

        .app-icon:hover .fa-youtube { color: #ff0000; }
        .app-icon:hover .fa-bilibili { color: #23ade5; }
        .app-icon:hover .fa-instagram { color: #e1306c; }
        .app-icon:hover .fa-threads { color: #fff; }

        .app-label {
            position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
            font-size: 10px; color: var(--primary); opacity: 0; transition: 0.3s;
            white-space: nowrap; pointer-events: none;
            background: rgba(0,0,0,0.8); padding: 4px 8px; border-radius: 4px;
            border: 1px solid var(--primary);
        }
        .app-icon:hover .app-label { opacity: 1; top: -45px; }

        /* --- 4. éŸ³æ¨‚æ’­æ”¾å™¨ (Music) - å„ªåŒ–ç‰ˆ --- */
        .music-widget {
            position: absolute; bottom: 8%; right: 8%;
            display: flex; align-items: flex-end; gap: 15px; z-index: 50;
        }
        
        /* é»‘è† è¨­è¨ˆ */
        .disc-art {
            width: 70px; height: 70px; background: #050505;
            border-radius: 50%; 
            border: 2px solid #333;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer; 
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            z-index: 52;
            position: relative;
            background-image: repeating-radial-gradient(#111 0, #111 4px, #222 5px, #222 6px);
            transition: 0.5s;
        }
        .disc-art::after {
            content: ''; position: absolute; top: -10px; right: -5px;
            width: 20px; height: 40px;
            border-right: 2px solid #666; border-top: 2px solid #666;
            transform: rotate(20deg); transform-origin: top right;
            transition: 0.5s; opacity: 0.5;
        }
        
        .disc-art.playing { 
            border-color: var(--primary); 
            box-shadow: 0 0 25px var(--glow-color); 
            /* æ—‹è½‰å‹•ç•« */
            animation: spin 5s linear infinite; 
        }
        .disc-art.playing::after { transform: rotate(45deg); opacity: 1; border-color: var(--primary); }
        
        body.combat-mode .disc-art.playing {
            border-color: var(--danger);
            box-shadow: 0 0 20px var(--danger);
        }
        .disc-inner {
            width: 35%; height: 35%; border-radius: 50%;
            background: var(--primary);
            border: 2px solid #000;
        }
        body.combat-mode .disc-inner { background: var(--danger); }
        
        /* Spotify å®¹å™¨ - é †æš¢å‹•ç•«ä¿®å¾©ç‰ˆ */
        .spotify-hidden-container {
            position: absolute; bottom: 90px; right: 0;
            width: 320px; 
            height: 400px; /* å›ºå®šé«˜åº¦ï¼Œé¿å… height å‹•ç•«å¡é “ */
            
            /* éš±è—ç‹€æ…‹ */
            opacity: 0; 
            pointer-events: none; 
            transform: translateY(20px) scale(0.9);
            transform-origin: bottom right;

            /* é«˜æ•ˆéæ¸¡ */
            transition: 
                opacity 0.4s ease, 
                transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); /* å½ˆæ€§æ•ˆæœ */
            
            z-index: 51;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            background: rgba(10, 10, 10, 0.85); /* åŠé€æ˜èƒŒæ™¯ */
            backdrop-filter: blur(12px); /* æ¯›ç»ç’ƒ */
            -webkit-backdrop-filter: blur(12px);
            
            border-radius: 16px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column;
        }
        .spotify-hidden-container.active { 
            opacity: 1; 
            pointer-events: all; 
            transform: translateY(0) scale(1); 
        }
        
        .spotify-search-bar {
            width: 100%; padding: 15px;
            background: rgba(255,255,255,0.05); 
            border: none; border-bottom: 1px solid #333;
            color: var(--primary); font-size: 13px; text-align: center;
            outline: none; box-sizing: border-box;
            font-family: 'Rajdhani', sans-serif; letter-spacing: 1px;
        }
        .spotify-search-bar:focus { border-bottom-color: var(--primary); background: rgba(255,255,255,0.1); }
        .spotify-search-bar::placeholder { color: #555; }

        /* --- 5. ä»»å‹™æ—¥èªŒ & è£é£¾æ–‡å­— --- */
        .decor-vertical {
            position: fixed; top: 15%; right: 6%;
            writing-mode: vertical-rl; text-orientation: upright;
            color: rgba(255,255,255,0.2);
            font-family: 'Shippori Mincho', serif;
            font-size: 14px; letter-spacing: 10px;
            z-index: 5; pointer-events: none;
            border-right: 1px solid rgba(255,255,255,0.1);
            padding-right: 15px;
        }
        body.combat-mode .decor-vertical { color: rgba(255, 42, 42, 0.4); border-right-color: var(--danger); }

        .log-panel {
            position: fixed; top: 10%; right: 12%; width: 300px;
            background: rgba(5,5,5,0.9); border: 1px solid #333; border-top: 2px solid var(--accent);
            padding: 20px; transform: translateX(50px); opacity: 0; pointer-events: none;
            transition: 0.4s; z-index: 20;
        }
        .log-panel.active { transform: translateX(0); opacity: 1; pointer-events: all; }
        .log-textarea {
            width: 100%; height: 150px; background: #111; border: 1px solid #333;
            color: #ccc; padding: 10px; font-family: 'Noto Sans JP'; resize: none; outline: none; box-sizing: border-box;
        }
        .log-trigger {
            position: fixed; top: 10%; right: 0;
            writing-mode: vertical-rl; text-orientation: upright;
            background: var(--dark); border: 1px solid #333; border-right: none;
            padding: 15px 5px; cursor: pointer; color: #888;
            font-size: 12px; letter-spacing: 3px; transition: 0.3s; z-index: 21;
        }
        .log-trigger:hover { color: var(--accent); background: #111; }

        /* --- 6. é–‹æ©Ÿå‹•ç•« --- */
        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 1s;
        }
        .ignite-btn {
            margin-top: 50px; border: 1px solid var(--primary); padding: 15px 40px;
            color: var(--primary); font-weight: 700; letter-spacing: 3px; cursor: pointer;
            background: rgba(0,0,0,0.5); transition: 0.3s;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }
        .ignite-btn:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary); }

        /* å‹•ç•« Keyframes */
        @keyframes spin { 
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); } 
        }
        @keyframes flashRed {
            0% { box-shadow: inset 0 0 0 0 rgba(255, 0, 0, 0); }
            50% { box-shadow: inset 0 0 100px 0 rgba(255, 0, 0, 0.5); }
            100% { box-shadow: inset 0 0 0 0 rgba(255, 0, 0, 0); }
        }
        .red-alert { animation: flashRed 0.5s ease-out; }
        .warning-strip {
            position: fixed; top: 0; width: 100%; height: 5px;
            background: repeating-linear-gradient(45deg, var(--danger), var(--danger) 20px, #000 20px, #000 40px);
            z-index: 100; opacity: 0; transition: 0.5s;
        }
        body.combat-mode .warning-strip { opacity: 1; }

        /* --- ç‰¹æ•ˆï¼šCRT æƒæç·š --- */
.scanlines {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    /* å‰µé€ æ©«æ¢ç´‹ */
    background: linear-gradient(
        to bottom,
        rgba(255,255,255,0),
        rgba(255,255,255,0) 50%,
        rgba(0,0,0,0.2) 50%,
        rgba(0,0,0,0.2)
    );
    background-size: 100% 4px; /* ç·šæ¢ç²—ç´° */
    z-index: 900; /* è“‹åœ¨èƒŒæ™¯ä¸Šï¼Œä½†åœ¨æŒ‰éˆ•ä¸‹ */
    pointer-events: none; /* æ»‘é¼ ç©¿é€ */
    opacity: 0.7;
}

        /* --- ç‰¹æ•ˆï¼šé»æ“Šè¡æ“Šæ³¢ --- */
.shockwave {
    position: absolute;
    width: 20px; height: 20px;
    border: 2px solid var(--primary);
    border-radius: 50%;
    pointer-events: none; /* è®“æ»‘é¼ å¯ä»¥ç©¿é€å®ƒ */
    z-index: 9999;
    animation: ripple 0.6s ease-out forwards;
}

@keyframes ripple {
    0% { transform: scale(1); opacity: 1; border-width: 4px; }
    100% { transform: scale(15); opacity: 0; border-width: 0px; }
}

/* æˆ°é¬¥æ¨¡å¼ä¸‹çš„è¡æ“Šæ³¢è®Šç´…è‰² */
body.combat-mode .shockwave {
    border-color: var(--danger);
    box-shadow: 0 0 10px var(--danger);
}
/* --- è£œä¸Šå”±ç‰‡æ—‹è½‰å‹•ç•« --- */
@keyframes spin { 
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); } 
}

/* ç¢ºä¿ .playing é¡åˆ¥æœ‰åƒåˆ°å‹•ç•« */
.disc-art.playing { 
    animation: spin 5s linear infinite; 
    border-color: var(--primary);
    box-shadow: 0 0 20px var(--glow-color);
}

/* --- æ–°å¢ï¼šçˆ†ç‚¸é–ƒå…‰å±¤ --- */
#flash-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: white;
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 0.1s ease-out;
}

/* --- æ–°å¢ï¼šæ›´åŠ‡çƒˆçš„éœ‡å‹• --- */
@keyframes violent-shake {
    0% { transform: translate(0, 0) rotate(0deg); }
    25% { transform: translate(-10px, 10px) rotate(-1deg); }
    50% { transform: translate(10px, -10px) rotate(1deg); }
    75% { transform: translate(-10px, -10px) rotate(-1deg); }
    100% { transform: translate(0, 0) rotate(0deg); }
}

.violent-shake {
    animation: violent-shake 0.2s cubic-bezier(.36,.07,.19,.97) both;
    animation-iteration-count: 3; /* éœ‡å‹• 3 æ¬¡ */
}
/* åŠ å…¥é€™äº›æ–°çš„ CSS */
.clock-huge span {
    display: inline-block;
    text-align: center;
}

/* é€™æ˜¯æ•¸å­—çš„éƒ¨åˆ†ï¼Œè¨­å®šå›ºå®šå¯¬åº¦å¯ä»¥é˜²æ­¢è·³å‹• */
#clock-h, #clock-m, #clock-s {
    width: 1.2em; /* æ ¹æ“šå­—é«”å¤§å°èª¿æ•´ï¼Œç¢ºä¿æ•¸å­—æœ‰è¶³å¤ ç©ºé–“ */
    font-variant-numeric: tabular-nums; /* å¼·åˆ¶ç­‰å¯¬æ•¸å­— */
}

/* é€™æ˜¯å†’è™Ÿçš„éƒ¨åˆ†ï¼Œè®“å®ƒç¨å¾®çª„ä¸€é» */
.colon {
    width: 0.3em;
    position: relative;
    top: -5px; /* å¾®èª¿å†’è™Ÿçš„ä¸Šä¸‹ä½ç½® */
}
/* 1. é‡å°æ•´å€‹æ™‚é˜ï¼šä½¿ç”¨è² çš„å­—è·ä¾†æ”¶ç·Šæ•´é«” */
.clock-huge {
    /* è² æ•¸è¶Šå¤§ï¼Œå­—èˆ‡å­—ä¹‹é–“è¶Šç·Šï¼Œä½ å¯ä»¥è©¦è©¦ -0.05em åˆ° -0.1em */
    letter-spacing: -0.08em; 
}

/* 2. é‡å°æ•¸å­—å€å¡Šï¼šæŠŠåŸæœ¬é ç•™çš„å¯¬åº¦æ”¹çª„ */
#clock-h, #clock-m, #clock-s {
    display: inline-block;
    text-align: center;
    
    /* é€™è£¡åŸæœ¬å¯èƒ½æ˜¯ 1.2emï¼Œæˆ‘å€‘æŠŠå®ƒæ”¹çª„ */
    /* "ch" æ˜¯ä»¥ '0' çš„å¯¬åº¦ç‚ºå–®ä½çš„ï¼Œ1.7ch å¤§ç´„æ˜¯å…©å€‹æ•¸å­—ç·Šè²¼çš„å¯¬åº¦ */
    width: 1.65ch; 
}
/* --- 1. ä¿„èªè§£ç¢¼èˆ‡æ‰“å­—æ©Ÿç‰¹æ•ˆ --- */
.typing-cursor::after {
    content: 'â–‹';
    display: inline-block;
    color: var(--primary);
    animation: blink 1s step-end infinite;
    margin-left: 2px;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* --- 2. é»æ“Šçˆ†ç‚¸ç‰¹æ•ˆ (Bomb Girl Effect) --- */
.explosion-particle {
    position: fixed;
    pointer-events: none;
    border-radius: 50%;
    background: radial-gradient(circle, #fff 0%, #ff00de 40%, transparent 100%);
    transform: translate(-50%, -50%);
    animation: explode 0.6s ease-out forwards;
    z-index: 9999;
}

@keyframes explode {
    0% { width: 10px; height: 10px; opacity: 1; }
    100% { width: 150px; height: 150px; opacity: 0; }
}

/* è®“èªéŒ„æ–‡å­—æœ‰é»æ“Šæ‰‹æ„Ÿ */
#reze-status-text {
    cursor: pointer;
    transition: text-shadow 0.3s;
}
#reze-status-text:hover {
    text-shadow: 0 0 10px var(--primary);
}
    </style>
</head>
<body>

    <div class="scanlines"></div>
    <div class="grid-overlay"></div>
    <div class="vignette"></div>
    <div class="warning-strip"></div>
    
    <div class="combat-overlay">
        <div class="crosshair-lines"></div>
    </div>

    <canvas id="fx-canvas"></canvas>

    <div id="boot-screen">
        <div class="boot-text" style="font-family:'Shippori Mincho'; color:var(--primary); font-size:2rem; letter-spacing:0.5em; border-bottom:1px solid var(--danger); padding-bottom:10px; margin-bottom:20px;">çˆ†å¼¾ã®æ‚ªé­”</div>
        <div class="boot-sub" style="font-family:'Rajdhani'; color:#555;">SYSTEM: BOMB-DEVIL-V42 // REFINED</div>
        <div class="ignite-btn" id="start-btn">æ¥ç¶šé–‹å§‹</div>
    </div>

<video id="bg-video" autoplay loop muted playsinline>
    <source src="video.mp4" type="video/mp4">
</video>

    <div class="hud-container">
                <div class="greeting-jp glitch-hover" id="greeting">...</div>
        <div class="clock-huge">
    <span id="clock-h">00</span><span class="colon">:</span><span id="clock-m">00</span><span class="colon">:</span><span id="clock-s">00</span>
</div>
        <div class="date-jp" id="date">--æœˆ--æ—¥</div>
        <div class="reze-status-box">
            <i class="fa-solid fa-terminal"></i>
            <span id="reze-status-text" class="fade-text">System Standby...</span>
        </div>

        <div class="pin-system" title="å®‰å…¨æ “ (Safety Pin)">
            <div class="choker-pin" id="safety-pin">
                <i class="fa-solid fa-link"></i>
            </div>
            <div class="status-group">
                <span class="status-label">SYSTEM STATUS</span>
                <span class="status-main glitch-hover" id="status-text">é€šå¸¸ãƒ¢ãƒ¼ãƒ‰</span>
            </div>
        </div>

        <div class="search-box">
            <input type="text" id="g-search-input" class="search-input" placeholder="Google æ¤œç´¢...">
            <i class="fa-solid fa-magnifying-glass search-icon" id="g-search-icon"></i>
        </div>
    </div>

    <div class="decor-vertical">
        ã‚½é€£ã®æˆ¦å£«<br>
        çˆ†å¼¾ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰<br>
        èŠ±ã¨ç«è–¬
    </div>

<div class="log-trigger" id="log-btn">ä»»å‹™è¨˜éŒ²</div>
    <div class="log-panel" id="logPanel">
        <div class="log-title" style="color:var(--accent); display:flex; justify-content:space-between; margin-bottom:10px;">
            <span>MISSION LOG</span>
<i class="fa-solid fa-floppy-disk" style="cursor:pointer" id="save-log-btn"></i>
        </div>
        <textarea class="log-textarea" id="logInput" placeholder="æ©Ÿå¯†æƒ…å ±ã‚’å…¥åŠ›..."></textarea>
    </div>

    <div class="app-bar">
        <a href="https://ani.gamer.com.tw" target="_blank" class="app-icon" title="å‹•æ¼«ç˜‹">
            <i class="fa-solid fa-play"></i>
            <span class="app-label">Anime</span>
        </a>
        <a href="https://www.youtube.com" target="_blank" class="app-icon" title="YouTube">
            <i class="fa-brands fa-youtube"></i>
            <span class="app-label">YouTube</span>
        </a>
        
        <a href="https://www.netflix.com" target="_blank" class="app-icon netflix-color" title="Netflix">
            <i class="fa-solid fa-n"></i> 
            <span class="app-label" style="border-color: #E50914; color: #E50914;">Netflix</span>
        </a>

        <a href="https://www.instagram.com" target="_blank" class="app-icon" title="Instagram">
            <i class="fa-brands fa-instagram"></i>
            <span class="app-label">Instagram</span>
        </a>
        <a href="https://www.threads.net" target="_blank" class="app-icon" title="Threads">
            <i class="fa-brands fa-threads"></i>
            <span class="app-label">Threads</span>
        </a>
        <a href="https://www.bilibili.com" target="_blank" class="app-icon" title="Bilibili">
            <i class="fa-brands fa-bilibili"></i>
            <span class="app-label">Bilibili</span>
        </a>
        
        <div class="app-icon spotify-color" id="music-btn" title="Music Player">
            <i class="fa-brands fa-spotify"></i>
            <span class="app-label" style="border-color: var(--spotify-green); color: var(--spotify-green);">Music</span>
        </div>
    </div>

    <div class="music-widget">
        <div id="spotify-container" class="spotify-hidden-container">
            <input type="text" id="spotify-input" class="spotify-search-bar" 
                   placeholder="Spotify Song/Playlist Link...">
            
            <iframe id="spotify-frame" style="border-radius:0 0 12px 12px; flex-grow:1;" 
    src="https://open.spotify.com/embed/artist/38WbKH6oKAZskBhqDFA8Uj?utm_source=generator" 
    width="100%" height="100%" 
    frameBorder="0" 
    allowfullscreen="" 
    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
    loading="lazy">
</iframe>
        </div>

        <div class="disc-art" id="disc">
            <div class="disc-inner"></div>
        </div>
    </div>
 </body> 
 
 <script>
  

/* --- Reze OS V42 [Final Ultimate] - éŸ³æ•ˆå®Œå…¨ç‰ˆ --- */

// --- å…¨åŸŸè®Šæ•¸ ---
let combatMode = false;
let particles = [];
const canvas = document.getElementById('fx-canvas');
const ctx = canvas ? canvas.getContext('2d') : null;

// --- è¨˜æ†¶é«”è¨­å®š ---
const MEMORY = {
    SONG: 'reze_saved_song_url',
    LOG: 'reze_saved_log'
};

// --- éŸ³æ•ˆç³»çµ±è¨­å®š (SFX System) ---
// è«‹ç¢ºä¿ä½ çš„è³‡æ–™å¤¾å…§æœ‰é€™ä¸‰å€‹æª”æ¡ˆï¼Œå¦å‰‡æ²’è²éŸ³
const SFX = {
    hover: new Audio('hover.mp3'),  // æ»‘é¼ æ»‘é
    click: new Audio('click.mp3'),  // é»æ“Šç¢ºèª
    boom:  new Audio('boom.mp3')    // æˆ°é¬¥æ¨¡å¼/çˆ†ç‚¸
};

// éŸ³é‡èª¿æ•´ (0.0 ~ 1.0) -> é¿å…åš‡åˆ°è‡ªå·±
SFX.hover.volume = 0.2; // è¼•å¾®çš„è²éŸ³
SFX.click.volume = 0.4; // æ¸…æ¥šçš„æ©Ÿæ¢°è²
SFX.boom.volume  = 0.6; // éœ‡æ’¼çš„è²éŸ³

// é è¨­æ­Œæ›²
// é è¨­æ­Œæ›²
const DEFAULT_SONG = "https://open.spotify.com/embed/artist/38WbKH6oKAZskBhqDFA8Uj?utm_source=generator";
// --- åˆå§‹åŒ– ---
document.addEventListener('DOMContentLoaded', () => {
    console.log("Reze System: ç³»çµ±å•Ÿå‹•ä¸­ (å«éŸ³æ•ˆæ¨¡çµ„)...");

    loadMemory();
    initClock();
    startRezeStatusLoop();
    bindEvents();
    
    // ç¶å®šæ‰€æœ‰äº’å‹•éŸ³æ•ˆ
    initInteractionSounds();

    if (canvas) {
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        animateParticles();
        document.addEventListener('mousemove', handleMouseMove);
    }
});

/* --- 0. éŸ³æ•ˆè§¸ç™¼å‡½å¼ --- */
function playSound(type) {
    // ç°¡å–®çš„é˜²éŒ¯æ©Ÿåˆ¶
    if (SFX[type]) {
        SFX[type].currentTime = 0; // æ¯æ¬¡æ’­æ”¾éƒ½å¾é ­é–‹å§‹ (é©åˆå¿«é€Ÿé€£é»)
        SFX[type].play().catch(e => console.log("ç­‰å¾…ä½¿ç”¨è€…äº’å‹•å¾Œæ‰èƒ½æ’­æ”¾éŸ³æ•ˆ"));
    }
}

// è‡ªå‹•å¹«æ‰€æœ‰æŒ‰éˆ•åŠ éŸ³æ•ˆ
function initInteractionSounds() {
    // é‡å°æ‰€æœ‰ App åœ–ç¤ºã€æŒ‰éˆ•ã€è¼¸å…¥æ¡†åŠ å…¥æ»‘éèˆ‡é»æ“ŠéŸ³æ•ˆ
    const interactiveElements = document.querySelectorAll('.app-icon, .ignite-btn, .choker-pin, .log-trigger, .search-icon, .fa-floppy-disk');

    interactiveElements.forEach(el => {
        el.addEventListener('mouseenter', () => playSound('hover'));
        el.addEventListener('click', () => playSound('click'));
    });
}

/* --- 1. æ ¸å¿ƒè¨˜æ†¶åŠŸèƒ½ --- */
function loadMemory() {
    console.log("æ­£åœ¨è®€å–è¨˜æ†¶...");
    const savedSong = localStorage.getItem(MEMORY.SONG);
    const frame = document.getElementById('spotify-frame');
    const container = document.getElementById('spotify-container');
    const disc = document.getElementById('disc');

    if (frame) {
        if (savedSong && savedSong.includes('embed')) {
            frame.src = savedSong;
            if(container) container.classList.add('active');
            if(disc) disc.classList.add('playing');
        } else {
            frame.src = DEFAULT_SONG;
        }
    }

    const savedLog = localStorage.getItem(MEMORY.LOG);
    const logInput = document.getElementById('logInput');
    if (savedLog && logInput) logInput.value = savedLog;
}

function handleSpotifySearch(e) {
    if (e.key === 'Enter') {
        playSound('click'); // éŸ³æ•ˆ
        let val = e.target.value.trim();
        const frame = document.getElementById('spotify-frame');
        
        if (!val || !frame) return;

        if (val.includes('open.spotify.com') && !val.includes('/embed')) {
            val = val.replace('/track/', '/embed/track/')
                     .replace('/playlist/', '/embed/playlist/')
                     .replace('/album/', '/embed/album/');
        }
        if (val.indexOf('?') > -1) val = val.split('?')[0]; 

        frame.src = val;
        localStorage.setItem(MEMORY.SONG, val);
        e.target.value = ''; 
        ensureMusicPlayingState();
    }
}

function ensureMusicPlayingState() {
    const container = document.getElementById('spotify-container');
    const disc = document.getElementById('disc');
    if (container) container.classList.add('active');
    if (disc) disc.classList.add('playing');
}

/* --- 2. äº‹ä»¶ç¶å®š --- */
function bindEvents() {
    const startBtn = document.getElementById('start-btn');
    if (startBtn) startBtn.addEventListener('click', startSystem);

    const safetyPin = document.getElementById('safety-pin');
    if (safetyPin) safetyPin.addEventListener('click', toggleCombatMode);

    const musicBtn = document.getElementById('music-btn');
    const disc = document.getElementById('disc');
    if (musicBtn) musicBtn.addEventListener('click', toggleMusicUI);
    if (disc) disc.addEventListener('click', toggleMusicUI);

    const spotifyInput = document.getElementById('spotify-input');
    if (spotifyInput) spotifyInput.addEventListener('keypress', handleSpotifySearch);

    const gInput = document.getElementById('g-search-input');
    const gIcon = document.getElementById('g-search-icon');
    if (gInput) gInput.addEventListener('keypress', (e) => { 
        if (e.key === 'Enter') { playSound('click'); executeSearch(); } 
    });
    if (gIcon) gIcon.addEventListener('click', executeSearch);

    const logBtn = document.getElementById('log-btn');
    const saveLogBtn = document.getElementById('save-log-btn');
    const logInput = document.getElementById('logInput');
    
    if (logBtn) logBtn.addEventListener('click', () => {
        playSound('click');
        document.getElementById('logPanel').classList.toggle('active');
    });
    
    if (saveLogBtn) saveLogBtn.addEventListener('click', saveLog);
    if (logInput) logInput.addEventListener('blur', saveLog);
}

function saveLog() {
    playSound('click'); // å­˜æª”éŸ³æ•ˆ
    const input = document.getElementById('logInput');
    if (input) {
        localStorage.setItem(MEMORY.LOG, input.value);
        const btn = document.getElementById('save-log-btn');
        if(btn) btn.style.color = "var(--accent)";
        setTimeout(() => { if(btn) btn.style.color = ""; }, 500);
    }
}

/* --- 3. ç³»çµ±åŠŸèƒ½ --- */
function startSystem() {
    // é€™ä¸€é»æ“Šéå¸¸é‡è¦ï¼Œå®ƒè§£é–äº†ç€è¦½å™¨çš„éŸ³æ•ˆæ’­æ”¾æ¬Šé™
    playSound('click'); 
    
    const bootScreen = document.getElementById('boot-screen');
    if (bootScreen) {
        bootScreen.style.opacity = "0";
        bootScreen.style.transform = "scale(1.1)";
        setTimeout(() => { bootScreen.style.display = "none"; }, 800);
    }
}

function initClock() {
    updateTime();
    setInterval(updateTime, 1000);
}

function updateTime() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2, '0');
    const m = String(now.getMinutes()).padStart(2, '0');
    const clock = document.getElementById('clock');
    if (clock) clock.innerText = `${h}:${m}`;
    const dateEl = document.getElementById('date');
    const days = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
    if (dateEl) dateEl.innerText = `${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥ (${days[now.getDay()]})`;
    updateGreeting(now.getHours());
}

function updateGreeting(hour) {
    const el = document.getElementById('greeting');
    if (!el) return;
    if (hour < 6) el.innerText = "æ·±å¤œã®ä»»å‹™ã‹ï¼Ÿ";
    else if (hour < 11) el.innerText = "ãŠã¯ã‚ˆã†ã€ãƒ¬ã‚¼ã€‚";
    else if (hour < 17) el.innerText = "ã“ã‚“ã«ã¡ã¯ã€‚";
    else el.innerText = "ã“ã‚“ã°ã‚“ã¯ã€ãƒ¬ã‚¼ã€‚";
}

function executeSearch() {
    const input = document.getElementById('g-search-input');
    if (input && input.value.trim()) {
        window.open(`https://www.google.com/search?q=${encodeURIComponent(input.value.trim())}`, '_blank');
        input.value = '';
    }
}

function toggleMusicUI() {
    playSound('click');
    const container = document.getElementById('spotify-container');
    const disc = document.getElementById('disc');
    if (container) {
        container.classList.toggle('active');
        if (container.classList.contains('active') && disc) {
            disc.classList.add('playing');
        }
    }
}

/* --- 4. æˆ°é¬¥æ¨¡å¼ (å«éŸ³æ•ˆ) --- */
function toggleCombatMode() {
    combatMode = !combatMode;
    document.body.classList.toggle('combat-mode');
    
    // â˜…â˜…â˜… è§¸ç™¼éŸ³æ•ˆ â˜…â˜…â˜…
    if (combatMode) {
        playSound('boom'); // çˆ†ç‚¸è²
    } else {
        playSound('click'); // é—œé–‰è²
    }

    const statusText = document.getElementById('status-text');
    if (statusText) {
        statusText.innerText = combatMode ? "æˆ¦é—˜æº–å‚™å®Œäº†" : "é€šå¸¸ãƒ¢ãƒ¼ãƒ‰";
        statusText.style.color = combatMode ? "var(--danger)" : "#fff";
    }

  if (combatMode) {
    // çˆ†ç‚¸æ™‚ä½¿ç”¨åŠ‡çƒˆéœ‡å‹•
    document.body.classList.add('red-alert', 'violent-shake');
    setTimeout(() => document.body.classList.remove('red-alert', 'violent-shake'), 600); // éœ‡å‹•ä¹…ä¸€é»
    explodeParticles(window.innerWidth / 2, window.innerHeight / 2);
}
    updateRezeStatus();
}

const quotesNormal = ["å›ã®å¿ƒè‡“ã‚’ã‚‚ã‚‰ã†ã€‚", "ç”°èˆã®ãƒã‚ºãƒŸãŒå¥½ã...", "å­¦æ ¡...æ¥½ã—ã‹ã£ãŸãªã€‚", "Safety pin: SECURE"];
const quotesCombat = ["Boom!", "çš†æ®ºã—ãƒ¢ãƒ¼ãƒ‰ã€‚", "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼šæ’é™¤é–‹å§‹ã€‚", "Danger Level: CRITICAL"];

function startRezeStatusLoop() { setInterval(updateRezeStatus, 6000); }
function updateRezeStatus() {
    const el = document.getElementById('reze-status-text');
    if (!el) return;
    const list = combatMode ? quotesCombat : quotesNormal;
    el.style.opacity = '0';
    setTimeout(() => {
        el.innerText = list[Math.floor(Math.random() * list.length)];
        el.style.opacity = '1';
        el.style.color = combatMode ? "var(--danger)" : "rgba(255,255,255,0.7)";
    }, 500);
}

/* --- 5. è¦–è¦ºç‰¹æ•ˆ (ç…™èŠ± + æ…¢æ¶ˆæ•£ç‰ˆ) --- */
function resizeCanvas() { if(canvas){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }}

function handleMouseMove(e) {
    const bg = document.getElementById('bg-video');
    if(bg) {
        // èƒŒæ™¯è¦–å·®ç§»å‹• (è®“ä½ çš„ video.mp4 è·Ÿè‘—æ»‘é¼ å‹•)
        const x = (window.innerWidth - e.pageX * 2) / 100;
        const y = (window.innerHeight - e.pageY * 2) / 100;
        bg.style.transform = `translate(${x}px, ${y}px) scale(1.05)`;
    }
    // æ»‘é¼ è»Œè·¡ (å°‘é‡)
    if(Math.random() > 0.8) particles.push(new Particle(e.pageX, e.pageY, 'trail'));
}

// ç…™èŠ±é…è‰² (è•¾æ½”é¢¨æ ¼ï¼šç´«ã€ç´…ã€é’ã€ç™½)
const FIREWORK_COLORS = ['#ff4d4d', '#a64dff', '#4dffdb', '#ffff66', '#ffffff'];

class Particle {
    constructor(x, y, type) {
        this.x = x; 
        this.y = y; 
        this.type = type;
        this.life = 1.0; 

        if(type === 'explode') {
            // --- ç…™èŠ±ç‰©ç†è¨­å®š ---
            const angle = Math.random() * Math.PI * 2;
            const speed = Math.random() * 12 + 2; // é€Ÿåº¦å¿«æ…¢ä¸ä¸€ï¼Œè£½é€ å±¤æ¬¡
            
            this.vx = Math.cos(angle) * speed;
            this.vy = Math.sin(angle) * speed;
            
            this.color = FIREWORK_COLORS[Math.floor(Math.random() * FIREWORK_COLORS.length)];
            this.size = Math.random() * 4 + 2;
            
            // â˜… é—œéµï¼šæ¥µæ…¢çš„æ¶ˆæ•£é€Ÿåº¦ (è®“ç…™èŠ±åœç•™æ›´ä¹…)
            this.decay = Math.random() * 0.005 + 0.005; 
            
            this.gravity = 0.05;  // è¼•å¾®é‡åŠ› (é£„è½æ„Ÿ)
            this.friction = 0.96; // ç©ºæ°£é˜»åŠ› (ç‚¸é–‹å¾Œåœæ»¯åœ¨ç©ºä¸­)

        } else if (type === 'shockwave') {
            // è¡æ“Šæ³¢
            this.size = 1;
            this.maxSize = Math.random() * 100 + 200;
            this.decay = 0.05;
            this.vx = 0; this.vy = 0;
            this.color = '#fff';
        } else {
            // æ»‘é¼ è»Œè·¡
            this.vx = (Math.random()-0.5)*2; 
            this.vy = (Math.random()-0.5)*2;
            this.size = Math.random() * 3 + 1;
            this.decay = 0.02;
            this.gravity = 0;
            this.friction = 1;
            this.color = combatMode ? 'rgba(255, 50, 50, 0.5)' : 'rgba(212, 163, 255, 0.5)';
        }
    }

    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.life -= this.decay;

        if (this.type === 'explode') {
            this.vx *= this.friction; // é˜»åŠ›è®“é€Ÿåº¦è®Šæ…¢
            this.vy *= this.friction;
            this.vy += this.gravity;  // é‡åŠ›å¾€ä¸‹æ‰
        } else if (this.type === 'shockwave') {
            this.size += 15; 
            if (this.size > this.maxSize) this.life = 0;
        }
    }

    draw() {
        if(!ctx) return;
        ctx.save();
        ctx.globalAlpha = this.life;

        if (this.type === 'explode') {
            // ç…™èŠ±å…‰æšˆ
            ctx.shadowBlur = 15;
            ctx.shadowColor = this.color;
            ctx.fillStyle = this.color;
            
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
            ctx.fill();

        } else if (this.type === 'shockwave') {
            ctx.strokeStyle = `rgba(255, 255, 255, ${this.life})`;
            ctx.lineWidth = 5;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
            ctx.stroke();

        } else {
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
            ctx.fill();
        }
        ctx.restore();
    }
}

// è§¸ç™¼ç…™èŠ±
function explodeParticles(x, y) {
    // ç”¢ç”Ÿå¤§é‡ç²’å­
    for(let i=0; i<150; i++) {
        particles.push(new Particle(x, y, 'explode'));
    }
    // ç”¢ç”Ÿè¡æ“Šæ³¢
    particles.push(new Particle(x, y, 'shockwave'));
    
    // ç•«é¢é–ƒå…‰ (éœ€é…åˆ HTML çš„ #flash-overlay)
    triggerFlash();
}

function triggerFlash() {
    const flash = document.getElementById('flash-overlay');
    if(flash) {
        flash.style.opacity = '0.6';
        setTimeout(() => { flash.style.opacity = '0'; }, 150);
    }
}

// --- ä¿®æ­£ç‰ˆå‹•ç•«è¿´åœˆ (è®“å½±ç‰‡é€å‡ºä¾†) ---
function animateParticles() {
    if(!ctx) return;

    // ğŸ”´ é—œéµä¿®æ”¹åœ¨é€™è£¡ï¼š
    // åŸæœ¬æ˜¯å¡—é»‘ (fillRect)ï¼Œç¾åœ¨æ”¹ç‚ºã€Œå®Œå…¨æ¸…é™¤ã€ (clearRect)
    // é€™æ¨£ Canvas å°±æœƒè®Šå›é€æ˜ï¼Œåº•ä¸‹çš„ video.mp4 æ‰èƒ½è¢«çœ‹è¦‹
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for(let i=0; i<particles.length; i++) {
        particles[i].update();
        particles[i].draw();
        
        // ç•¶ç²’å­å£½å‘½çµæŸï¼Œå°‡å…¶ç§»é™¤
        if(particles[i].life <= 0){ 
            particles.splice(i,1); 
            i--; 
        }
    }
    requestAnimationFrame(animateParticles);
}
function updateClock() {
    const now = new Date();
    
    // 1. ç²å–æ™‚é–“æ•¸å­—
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    
    // 2. ç²å–æ—¥æœŸèˆ‡æ˜ŸæœŸ
    const month = now.getMonth() + 1;
    const day = now.getDate();
    const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
    const weekDay = days[now.getDay()];

    // 3. æ›´æ–° HTML å…§å®¹ (é‡å°æ‹†é–‹å¾Œçš„ ID)
    const hEl = document.getElementById('clock-h');
    const mEl = document.getElementById('clock-m');
    const sEl = document.getElementById('clock-s');

    // â˜… åªæœ‰æ•¸å­—è®Šå‹•æ™‚æ‰æ›´æ–° (é˜²æ­¢é–ƒçˆçš„é—œéµ)
    if (hEl && hEl.innerText !== hours) hEl.innerText = hours;
    if (mEl && mEl.innerText !== minutes) mEl.innerText = minutes;
    if (sEl && sEl.innerText !== seconds) sEl.innerText = seconds;

    // æ›´æ–°æ—¥æœŸ
    const dateEl = document.getElementById('date');
    if (dateEl) {
        const dateStr = `${month}æœˆ${day}æ—¥ (${weekDay})`;
        if (dateEl.innerText !== dateStr) dateEl.innerText = dateStr;
    }
}

// è¨˜å¾—ç¢ºä¿é€™ä¸€è¡Œæœ‰åœ¨å‡½æ•¸å¤–é¢ï¼Œè®“æ™‚é˜å•Ÿå‹•
setInterval(updateClock, 1000);
updateClock(); // é é¢è¼‰å…¥æ™‚å…ˆåŸ·è¡Œä¸€æ¬¡
// --- Reze OS æ ¸å¿ƒèªéŒ„åº« ---
const rezeData = [
    // === æ™®é€šæ¨¡å¼ (Normal) ===
    { ja: "ç”°èˆã®ãƒã‚ºãƒŸãŒå¥½ã...", ru: "Ğ¯ Ğ»ÑĞ±Ğ»Ñ Ğ´ĞµÑ€ĞµĞ²ĞµĞ½ÑĞºĞ¸Ñ… Ğ¼Ñ‹ÑˆĞµĞ¹...", mode: "normal", time: "any" },
    { ja: "å›ã€å­¦æ ¡ã¯æ¥½ã—ã„ï¼Ÿ", ru: "Ğ¢ĞµĞ±Ğµ Ğ½Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ ÑˆĞºĞ¾Ğ»Ğ°?", mode: "normal", time: "day" },
    { ja: "ã‚³ãƒ¼ãƒ’ãƒ¼ã€æ·¹ã‚Œã‚ˆã†ã‹ã€‚", ru: "Ğ¡Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ‚ĞµĞ±Ğµ ĞºĞ¾Ñ„Ğµ?", mode: "normal", time: "morning" },
    { ja: "ã“ã®ã‚«ãƒ•ã‚§ã€æ•™ãˆãŸããªã‹ã£ãŸãªã€‚", ru: "ĞĞµ Ñ…Ğ¾Ñ‚ĞµĞ»Ğ° Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ¾ ĞºĞ°Ñ„Ğµ.", mode: "normal", time: "any" },
    { ja: "ç§ã¨...é€ƒã’ãªã„ï¼Ÿ", ru: "ĞĞµ Ñ…Ğ¾Ñ‡ĞµÑˆÑŒ ÑĞ±ĞµĞ¶Ğ°Ñ‚ÑŒ ÑĞ¾ Ğ¼Ğ½Ğ¾Ğ¹?", mode: "normal", time: "any" },
    { ja: "é­”æ³•...è¦‹ã‚‹ï¼Ÿ", ru: "Ğ¥Ğ¾Ñ‡ĞµÑˆÑŒ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ¼Ğ°Ğ³Ğ¸Ñ?", mode: "normal", time: "night" },
    { ja: "ã¾ã èµ·ãã¦ã‚‹ã®ï¼Ÿ", ru: "Ğ’ÑÑ‘ ĞµÑ‰Ñ‘ Ğ½Ğµ ÑĞ¿Ğ¸ÑˆÑŒ?", mode: "normal", time: "night" },
    { ja: "ä»»å‹™ãŒãªã„æ—¥ã¯é€€å±ˆã ã­ã€‚", ru: "Ğ¡ĞºÑƒÑ‡Ğ½Ğ¾ Ğ±ĞµĞ· Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹.", mode: "normal", time: "day" },
    { ja: "å›ã®åŒ‚ã„ã€è¦šãˆãŸã‚ˆã€‚", ru: "Ğ¯ Ğ·Ğ°Ğ¿Ğ¾Ğ¼Ğ½Ğ¸Ğ»Ğ° Ñ‚Ğ²Ğ¾Ğ¹ Ğ·Ğ°Ğ¿Ğ°Ñ….", mode: "normal", time: "any" },
    { ja: "ã‚¸ã‚§ãƒ¼ãƒ³ã¯ã©ã“...", ru: "Ğ“Ğ´Ğµ Ğ”Ğ¶ĞµĞ¹Ğ½...", mode: "normal", time: "any" },

    // === æˆ°é¬¥æ¨¡å¼ (Combat) ===
    { ja: "Boom!", ru: "Ğ‘ÑƒĞ¼!", mode: "combat", time: "any" },
    { ja: "å›ã®å¿ƒè‡“ã‚’ã‚‚ã‚‰ã†ã€‚", ru: "Ğ¯ Ğ·Ğ°Ğ±ĞµÑ€Ñƒ Ñ‚Ğ²Ğ¾Ğµ ÑĞµÑ€Ğ´Ñ†Ğµ.", mode: "combat", time: "any" },
    { ja: "å…¨å“¡ã€æ®ºã™ã­ã€‚", ru: "Ğ¯ ÑƒĞ±ÑŒÑ Ğ¸Ñ… Ğ²ÑĞµÑ….", mode: "combat", time: "any" },
    { ja: "Safety pin: RELEASED", ru: "Ğ§ĞµĞºĞ°: Ğ¡ĞĞ¯Ğ¢Ğ", mode: "combat", time: "any" },
    { ja: "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼šæ’é™¤é–‹å§‹ã€‚", ru: "Ğ¦ĞµĞ»ÑŒ: ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ ÑƒÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ.", mode: "combat", time: "any" },
    { ja: "é€ƒãŒã•ãªã„ã‚ˆã€‚", ru: "ĞĞµ ÑƒĞ¹Ğ´ĞµÑˆÑŒ.", mode: "combat", time: "any" },
    { ja: "èŠ±ç«ã€ç¶ºéº—ã ã£ãŸã­ã€‚", ru: "Ğ¤ĞµĞ¹ĞµÑ€Ğ²ĞµÑ€Ğº Ğ±Ñ‹Ğ» ĞºÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğ¼.", mode: "combat", time: "any" },
    { ja: "ãƒ‡ãƒ³ã‚¸å›...", ru: "Ğ”ĞµĞ½Ğ´Ğ¶Ğ¸...", mode: "combat", time: "any" },
    { ja: "æ­»ã¬ã¾ã§æ®ºã—åˆãŠã†ï¼Ÿ", ru: "Ğ”Ğ°Ğ²Ğ°Ğ¹ ÑƒĞ±Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ° Ğ´Ğ¾ ÑĞ¼ĞµÑ€Ñ‚Ğ¸?", mode: "combat", time: "night" },
    { ja: "ãƒœãƒ³ãƒƒï¼", ru: "Ğ’Ğ·Ñ€Ñ‹Ğ²!", mode: "combat", time: "any" }
];

// é»æ“ŠèªéŒ„æ™‚çš„åæ‡‰
const touchReactions = [
    "è§¦ã‚‰ãªã„ã§ã€‚", // åˆ¥ç¢°
    "ãã™ãã£ãŸã„ã‚ˆã€‚", // å¥½ç™¢
    "çˆ†ç™ºã™ã‚‹ã‚ˆï¼Ÿ", // æœƒçˆ†ç‚¸å–”ï¼Ÿ
    "......"
];
let isTyping = false; // é˜²æ­¢é‡è¤‡è§¸ç™¼

// ä¸»å‡½æ•¸ï¼šæ›´æ–°ç‹€æ…‹æ–‡å­—
function updateRezeStatus() {
    if (isTyping) return; // å¦‚æœæ­£åœ¨æ‰“å­—ï¼Œä¸è¦æ‰“æ–·

    const el = document.getElementById('reze-status-text');
    if (!el) return;

    // 1. æ ¹æ“šæ™‚é–“å’Œæ¨¡å¼ç¯©é¸èªéŒ„
    const currentHour = new Date().getHours();
    const isNight = currentHour >= 22 || currentHour <= 5;
    const isMorning = currentHour >= 6 && currentHour <= 10;
    
    // ç¯©é¸ç¬¦åˆç•¶ä¸‹æƒ…å¢ƒçš„èªéŒ„
    const availableQuotes = rezeData.filter(q => {
        // å…ˆå°æ¨¡å¼ (Normal/Combat)
        const modeMatch = combatMode ? (q.mode === "combat") : (q.mode === "normal");
        if (!modeMatch) return false;

        // å†å°æ™‚é–“ (Time)
        if (q.time === "any") return true;
        if (q.time === "night" && isNight) return true;
        if (q.time === "morning" && isMorning) return true;
        if (q.time === "day" && !isNight && !isMorning) return true;
        return false;
    });

    // éš¨æ©Ÿé¸ä¸€å¥
    const data = availableQuotes[Math.floor(Math.random() * availableQuotes.length)];
    if (!data) return;

    // åŸ·è¡Œã€Œé–“è«œè§£ç¢¼ã€ç‰¹æ•ˆ
    playSpyDecodeEffect(el, data.ru, data.ja);
}

// ç‰¹æ•ˆæ ¸å¿ƒï¼šå…ˆæ‰“ä¿„èª -> åœé “ -> è®Šæ—¥èª
function playSpyDecodeEffect(element, russianText, japaneseText) {
    isTyping = true;
    element.innerHTML = "";
    element.classList.add('typing-cursor');
    element.style.color = combatMode ? "var(--danger)" : "var(--primary)"; // ä¿„èªæ™‚çš„é¡è‰²

    let i = 0;
    // éšæ®µä¸€ï¼šæ‰“å‡ºä¿„èª
    function typeRussian() {
        if (i < russianText.length) {
            element.innerText += russianText.charAt(i);
            i++;
            setTimeout(typeRussian, 50); // æ‰“å­—é€Ÿåº¦
        } else {
            // ä¿„èªæ‰“å®Œï¼Œåœç•™ 0.8 ç§’
            setTimeout(() => {
                // éšæ®µäºŒï¼šè§£ç¢¼æˆæ—¥èª
                element.style.color = combatMode ? "var(--danger)" : "#fff"; // è®Šå›ç™½è‰²/ç´…è‰²
                typeJapanese(japaneseText); 
            }, 800);
        }
    }

    // éšæ®µä¸‰ï¼šæ—¥èªè¦†è“‹
    function typeJapanese(text) {
        element.innerText = text; // ç›´æ¥é¡¯ç¤ºæ—¥èª (æˆ–è€…ä½ è¦é€å­—æ‰“ä¹Ÿå¯ä»¥)
        // é€™è£¡åšä¸€å€‹ç°¡å–®çš„é–ƒçˆæ•ˆæœä»£è¡¨è§£ç¢¼å®Œæˆ
        element.style.opacity = 0;
        setTimeout(() => element.style.opacity = 1, 100);
        setTimeout(() => {
            isTyping = false;
            element.classList.remove('typing-cursor');
        }, 200);
    }

    typeRussian();
}

// --- çˆ†ç‚¸ç‰¹æ•ˆç›£è½ ---
document.addEventListener('click', (e) => {
    // åªæœ‰åœ¨æˆ°é¬¥æ¨¡å¼é»æ“ŠèƒŒæ™¯æ‰çˆ†ç‚¸
    if (typeof combatMode !== 'undefined' && combatMode) {
        createExplosion(e.clientX, e.clientY);
    }
});

// é»æ“Šæ–‡å­—çš„äº’å‹•å½©è›‹
document.getElementById('reze-status-text').addEventListener('click', (e) => {
    e.stopPropagation(); // é˜²æ­¢è§¸ç™¼èƒŒæ™¯çˆ†ç‚¸
    const el = document.getElementById('reze-status-text');
    const reaction = touchReactions[Math.floor(Math.random() * touchReactions.length)];
    el.innerText = reaction;
});

function createExplosion(x, y) {
    const explosion = document.createElement('div');
    explosion.classList.add('explosion-particle');
    explosion.style.left = `${x}px`;
    explosion.style.top = `${y}px`;
    document.body.appendChild(explosion);

    // çˆ†ç‚¸éŸ³æ•ˆ (å¯é¸ï¼Œå¦‚æœä½ æœ‰éŸ³æª”)
    // const audio = new Audio('explosion.mp3');
    // audio.volume = 0.2;
    // audio.play();

    setTimeout(() => explosion.remove(), 600);
}

// å•Ÿå‹•å¾ªç’°

setInterval(updateRezeStatus, 7000); // æ¯ 7 ç§’æ›ä¸€æ¬¡è©±
   </script>



</html>



